#:kivy 2.3.0
#:import SwapTransition kivy.uix.screenmanager.SwapTransition

MDFloatLayout:
    #size_hint: (None, None)
    size: (700, 480)

    # ---- Build Side Navigation ----

    MDFloatLayout:
        id: nav_bar_layout
        md_bg_color: app.theme_cls.bg_darkest
        size_hint: (0.05, 1)
        pos_hint: {'center_x': 0.025, 'center_y': 0.5}

        MDIconButton:
            id: nav_button_home
            icon: 'home'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 1.0, 'center_y': 0.93}
            size_hint: (1.2, 0.0875)
            on_release: app.navButtonRouter('nav_button_home')

        MDIconButton:
            id: nav_button_bemu
            icon: 'lightning-bolt'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 0.7, 'center_y': 0.83}
            size_hint: (1.2, 0.0875)
            on_release: app.navButtonRouter('nav_button_bemu')

        MDIconButton:
            id: nav_button_env
            icon: 'tailwind'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 0.7, 'center_y': 0.73}
            size_hint: (1.2, 0.0875)
            on_release: app.navButtonRouter('nav_button_env')

        MDIconButton:
            id: nav_button_ws
            icon: 'faucet'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 0.7, 'center_y': 0.63}
            size_hint: (1.2, 0.0875)
            on_release: app.navButtonRouter('nav_button_ws')

        MDIconButton:
            id: nav_button_ls
            icon: 'lightbulb-on'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 0.7, 'center_y': 0.53}
            size_hint: (1.2, 0.0875)
            on_release: app.navButtonRouter('nav_button_ls')

        MDIconButton:
            id: nav_button_theme
            icon: 'theme-light-dark'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 0.7, 'center_y': 0.27}
            size_hint: (1.2, 0.0875)
            on_release: app.switchTheme()

        MDIconButton:
            id: nav_button_settings
            icon: 'tune-vertical'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 0.7, 'center_y': 0.17}
            size_hint: (1.2, 0.0875)
            on_release: app.navButtonRouter('nav_button_settings')

        MDIconButton:
            id: nav_button_power
            icon: 'power'
            theme_text_color: 'Custom'
            text_color: app.theme_cls.accent_dark
            md_bg_color: app.theme_cls.primary_light
            ripple_scale: 0
            pos_hint: {'center_x': 0.7, 'center_y': 0.07}
            size_hint: (1.2, 0.0875)
            on_release: app.navButtonRouter('nav_button_power')

    # ---- Build Main Layout Page Manager ----

    PageManager:
        id: page_manager
        transition: SwapTransition(duration = 0.25)

        # ---- App Home Screen ----

        AppHomeScreen:
            name: 'app_home_page'

            MDFloatLayout:
                id: app_home_page_layout
                size_hint: (0.95, 1)
                pos_hint: {'center_x': 0.525, 'center_y': 0.5}

                # ---- Build Weather Card ----

                MDCard:
                    id: weather_quick_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.4, 0.9)
                    pos_hint: {'center_x': 0.275, 'center_y': 0.5}

                    MDFloatLayout:
                        MDLabel:
                            text: 'Outside Temp'
                            font_size: 28
                            theme_text_color: 'Hint'
                            pos_hint: {'center_x': 0.62, 'center_y': 0.78}

                        MDLabel:
                            id: outside_temp_quick_label
                            text: u'69\N{DEGREE SIGN}'
                            font_style: 'H2'
                            theme_text_color: 'Primary'
                            pos_hint: {'center_x': 0.64, 'center_y': 0.87}

                        MDIcon:
                            id: weather_icon
                            icon: 'cloud-question-outline'
                            theme_text_color: 'Hint'
                            font_size: 128
                            pos_hint: {'center_x': 0.72, 'center_y': 0.87}

                        MDLabel:
                            text: 'Today'
                            font_size: 36
                            theme_text_color: 'Hint'
                            pos_hint: {'center_x': 0.64, 'center_y': .66}
                        
                        MDLabel:
                            text: 'High'
                            font_size: 24
                            theme_text_color: 'Hint'
                            pos_hint: {'center_x': 0.97, 'center_y': .62}

                        MDLabel:
                            id: high_temp_quick_label
                            text: u'69\N{DEGREE SIGN}'
                            font_style: 'H4'
                            theme_text_color: 'Primary'
                            pos_hint: {'center_x': 0.95, 'center_y': 0.68}
                        
                        MDLabel:
                            text: 'Low'
                            font_size: 24
                            theme_text_color: 'Hint'
                            pos_hint: {'center_x': 1.23, 'center_y': .62}

                        MDLabel:
                            id: low_temp_quick_label
                            text: u'37\N{DEGREE SIGN}'
                            font_style: 'H5'
                            theme_text_color: 'Primary'
                            pos_hint: {'center_x': 1.22, 'center_y': 0.68}

                        MDWidget:
                            id: weather_card_separator

                            canvas:
                                Color:
                                    rgba: app.theme_cls.accent_light
                                Line:
                                    points: (0.15*kivy.core.window.Window.width, 0.56*kivy.core.window.Window.height, 0.475*kivy.core.window.Window.width, 0.56*kivy.core.window.Window.height)
                                    width: 2

                        MDLabel:
                            text: 'Inside Temp'
                            theme_text_color: 'Hint'
                            pos_hint: {'center_x': 0.63, 'center_y': .23}

                        MDLabel:
                            id: inside_temp_quick_label
                            text: u'69\N{DEGREE SIGN}'
                            font_style: 'H1'
                            theme_text_color: 'Primary'
                            pos_hint: {'center_x': 0.6, 'center_y': 0.37}

                        MDIconButton:
                            icon: 'plus-circle'
                            theme_text_color: 'Custom'
                            ripple_color: app.theme_cls.primary_light
                            ripple_alpha: 0.3
                            ripple_duration_in_fast: 0.1
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.85, 'center_y': 0.5}

                        MDLabel:
                            id: set_temp_quick_label
                            text: u'69\N{DEGREE SIGN}'
                            font_style: 'H4'
                            theme_text_color: 'Secondary'
                            pos_hint: {'center_x': 1.27, 'center_y': 0.38}

                        MDIconButton:
                            icon: 'minus-circle'
                            theme_text_color: 'Custom'
                            ripple_color: app.theme_cls.primary_light
                            ripple_alpha: 0.3
                            ripple_duration_in_fast: 0.1
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.85, 'center_y': 0.25}

                        EnvFanToggleButton:
                            id: env_fan_quick_switch
                            icon: 'fan'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.2, 'center_y': 0.09}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                        EnvCoolToggleButton:
                            id: env_cool_quick_switch
                            icon: 'snowflake'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.5, 'center_y': 0.09}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                        EnvHeatToggleButton:
                            id: env_heat_quick_switch
                            icon: 'fire'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.8, 'center_y': 0.09}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                # ---- Build Time & Date Card ----

                MDCard:
                    id: time_quick_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.4, 0.2)
                    pos_hint: {'center_x': 0.725, 'center_y': 0.85}

                # ---- Build BEMU Card ----

                MDCard:
                    id: bemu_quick_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.4, 0.2)
                    pos_hint: {'center_x': 0.725, 'center_y': 0.6}
                    on_release: app.navButtonRouter('nav_button_bemu')

                # ---- Build WS Card ----

                MDCard:
                    id: ws_quick_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.4, 0.2)
                    pos_hint: {'center_x': 0.725, 'center_y': 0.35}
                    #on_release: app.navButtonRouter('nav_button_ws')

                    MDFloatLayout:

                        MDIcon:
                            id: fresh_water_icon_75
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.primary_light
                            pos_hint: {'center_x': 0.2,'center_y': 0.8}
                        
                        MDIcon:
                            id: fresh_water_icon_50
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.primary_light
                            pos_hint: {'center_x': 0.2,'center_y': 0.6}
                        
                        MDIcon:
                            id: fresh_water_icon_25
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.primary_light
                            pos_hint: {'center_x': 0.2,'center_y': 0.4}
                        
                        MDIcon:
                            id: fresh_water_icon_0
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.primary_light
                            pos_hint: {'center_x': 0.2,'center_y': 0.2}

                        MDLabel:
                            id: fresh_water_label
                            text: 'Fresh\nWater'
                            halign: 'right'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            font_size: 12
                            bold: True
                            pos_hint: {'center_x': -0.35,'center_y': 0.5}

                        MDIcon:
                            id: fresh_to_pump_line
                            icon: 'minus'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.3,'center_y': 0.5}

                        WSPumpToggleButton:
                            id: ws_pump_switch
                            text: 'Pump'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.5, 'center_y': 0.72}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'
                        
                        WSHeaterToggleButton:
                            id: ws_heater_switch
                            text: 'Heater'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.5, 'center_y': 0.28}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                        MDIcon:
                            id: pump_to_grey_line
                            icon: 'minus'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.7,'center_y': 0.5}

                        MDIcon:
                            id: grey_water_icon_75
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_light
                            pos_hint: {'center_x': 0.8,'center_y': 0.8}
                        
                        MDIcon:
                            id: grey_water_icon_50
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_light
                            pos_hint: {'center_x': 0.8,'center_y': 0.6}
                        
                        MDIcon:
                            id: grey_water_icon_25
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_light
                            pos_hint: {'center_x': 0.8,'center_y': 0.4}
                        
                        MDIcon:
                            id: grey_water_icon_0
                            icon: 'square-rounded-outline'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_light
                            pos_hint: {'center_x': 0.8,'center_y': 0.2}

                        MDLabel:
                            id: grey_water_label
                            text: 'Grey\nWater'
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            font_size: 12
                            bold: True
                            pos_hint: {'center_x': 1.36,'center_y': 0.5}

                # ---- Build LS Card ----

                MDCard:
                    id: ls_quick_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.4, 0.15)
                    pos_hint: {'center_x': 0.725, 'center_y': 0.125}
                    #on_release: app.navButtonRouter('nav_button_ls')

                    MDFloatLayout:

                        DiningLightToggleButton:
                            id: ls_1_quick_switch
                            icon: 'table-furniture'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.15, 'center_y': 0.5}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                        BedroomLightToggleButton:
                            id: ls_2_quick_switch
                            icon: 'bed'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.38, 'center_y': 0.5}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                        KitchenLightToggleButton:
                            id: ls_3_quick_switch
                            icon: 'countertop'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.62, 'center_y': 0.5}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                        BathroomLightToggleButton:
                            id: ls_4_quick_switch
                            icon: 'shower-head'
                            md_bg_color: app.theme_cls.accent_light
                            ripple_scale: 0
                            theme_text_color: 'Custom'
                            text_color: app.theme_cls.accent_dark
                            pos_hint: {'center_x': 0.85, 'center_y': 0.5}
                            on_release: self.state = 'down' if self.state == 'normal' else 'normal'


        BEMUHomeScreen:
            name: 'bemu_home_page'

            MDFloatLayout:
                id: bemu_home_page_layout
                size_hint: (0.95, 1)
                pos_hint: {'center_x': 0.525, 'center_y': 0.5}

                # ---- Build Main Card ----

                MDCard:
                    id: bemu_home_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.85, 0.9)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        EnvHomeScreen:
            name: 'env_home_page'

            MDFloatLayout:
                id: env_home_page_layout
                size_hint: (0.95, 1)
                pos_hint: {'center_x': 0.525, 'center_y': 0.5}

                # ---- Build Main Card ----

                MDCard:
                    id: env_home_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.85, 0.9)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        WSHomeScreen:
            name: 'ws_home_page'

            MDFloatLayout:
                id: ws_home_page_layout
                size_hint: (0.95, 1)
                pos_hint: {'center_x': 0.525, 'center_y': 0.5}

                # ---- Build Main Card ----

                MDCard:
                    id: ws_home_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.85, 0.9)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        LSHomeScreen:
            name: 'ls_home_page'

            MDFloatLayout:
                id: ls_home_page_layout
                size_hint: (0.95, 1)
                pos_hint: {'center_x': 0.525, 'center_y': 0.5}

                # ---- Build Main Card ----

                MDCard:
                    id: ls_home_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.85, 0.9)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}

                    MDBoxLayout:
                        orientation: 'vertical'

                        MDFloatLayout:
                            orientation: 'horizontal'
                            size_hint: (1, 0.2)

                            DiningLightToggleButton:
                                id: ls_1_switch
                                icon: 'table-furniture'
                                md_bg_color: app.theme_cls.accent_light
                                ripple_scale: 0
                                theme_text_color: 'Custom'
                                text_color: app.theme_cls.accent_dark
                                pos_hint: {'center_x': 0.125, 'center_y': 0.5}
                                on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                            BedroomLightToggleButton:
                                id: ls_2_switch
                                icon: 'bed'
                                md_bg_color: app.theme_cls.accent_light
                                ripple_scale: 0
                                theme_text_color: 'Custom'
                                text_color: app.theme_cls.accent_dark
                                pos_hint: {'center_x': 0.375, 'center_y': 0.5}
                                on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                            KitchenLightToggleButton:
                                id: ls_3_switch
                                icon: 'countertop'
                                md_bg_color: app.theme_cls.accent_light
                                ripple_scale: 0
                                theme_text_color: 'Custom'
                                text_color: app.theme_cls.accent_dark
                                pos_hint: {'center_x': 0.625, 'center_y': 0.5}
                                on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                            BathroomLightToggleButton:
                                id: ls_4_switch
                                icon: 'shower-head'
                                md_bg_color: app.theme_cls.accent_light
                                ripple_scale: 0
                                theme_text_color: 'Custom'
                                text_color: app.theme_cls.accent_dark
                                pos_hint: {'center_x': 0.875, 'center_y': 0.5}
                                on_release: self.state = 'down' if self.state == 'normal' else 'normal'

                        MDBoxLayout:
                            orientation: 'horizontal'
                            size_hint: (1, 0.8)

                            MDSlider:
                                id: ls_1_slider
                                orientation: 'vertical'
                                min: 10
                                max: 255
                                step: 1
                                value: 191
                                hint: False
                                show_off: False
                                on_value: app.lightingAdjust(*args, 'ls_1_slider')

                            MDSlider:
                                id: ls_2_slider
                                orientation: 'vertical'
                                min: 10
                                max: 255
                                step: 1
                                value: 191
                                hint: False
                                show_off: False
                                on_value: app.lightingAdjust(*args, 'ls_2_slider')

                            MDSlider:
                                id: ls_3_slider
                                orientation: 'vertical'
                                min: 10
                                max: 255
                                step: 1
                                value: 191
                                hint: False
                                show_off: False
                                on_value: app.lightingAdjust(*args, 'ls_3_slider')

                            MDSlider:
                                id: ls_4_slider
                                orientation: 'vertical'
                                min: 10
                                max: 255
                                step: 1
                                value: 191
                                hint: False
                                show_off: False
                                on_value: app.lightingAdjust(*args, 'ls_4_slider')
        
        SettingsHomeScreen:
            name: 'settings_home_page'

            MDFloatLayout:
                id: settings_home_page_layout
                size_hint: (0.95, 1)
                pos_hint: {'center_x': 0.525, 'center_y': 0.5}

                # ---- Build Main Card ----

                MDCard:
                    id: settings_home_card
                    md_bg_color: app.theme_cls.bg_darkest
                    size_hint: (0.85, 0.9)
                    pos_hint: {'center_x': 0.5, 'center_y': 0.5}